const displayRoamJSONGraph=({canvas:e,roamJSON:t,precomputedGraph:n})=>{const o=performance.now();let s,r,i,l=0,d=null,a=[],f={x:0,y:0,prevX:0,prevY:0},c=!1,h=!0,m=!0,x=.01,y=.9,p=2.2e-7,u=.001;const v=.65,g=.001,E=1e-7;let w=.5;const S=200;let T=6;Math.PI;const k=.15,M=.003,W=.003,X=1664525,Y=1013904223,b=4294967296;let C=1;const I=()=>(C=(X*C+Y)%b)/b,L=e=>({x:I()-.5,y:I()-.5,dx:0,dy:0,title:e,numConnections:0,mass:1}),A=(e,t,n,o=[])=>({x:e,y:t,r:n,kids:o,tree:[],mass:0}),R=(e,t=0)=>{if(t>=20)return;const n=.5*e.r;e.tree=[A(e.x-n,e.y-n,n),A(e.x+n,e.y-n,n),A(e.x-n,e.y+n,n),A(e.x+n,e.y+n,n)];let o=0,s=0;for(let t of e.kids)e.tree[(t.x>e.x)+2*(t.y>e.y)].kids.push(t),o+=t.y,s+=t.x,e.mass+=t.mass;e.x=s/e.kids.length,e.y=o/e.kids.length;for(let n=0;n<4;n++){const o=e.tree[n].kids.length;o>1?R(e.tree[n],t+1):e.tree[n]=0===o?void 0:e.tree[n].kids[0]}},B=(e,t)=>{if(void 0===t)return;const n=e.x-t.x,o=e.y-t.y;if(void 0!==t.tree&&t.r/Math.sqrt(n*n+o*o)<w||void 0!==t.numConnections){const s=n*n*n*n*.1+o*o*o*o+E,r=e.inverseMass*(t.mass*p)/s;e.dx+=n*r,e.dy+=o*r}else t.tree.forEach(t=>B(e,t))},[O,P]=timeFunc(()=>{s.forEach(e=>{e.dx=e.dx*y,e.dy=e.dy*y,e.x-=Math.sign(e.x)*e.x*e.x*u,e.y-=Math.sign(e.y)*e.y*e.y*u,e.x+=e.dx,e.y+=e.dy})},"node loop");console.log(P);const q=()=>{r.forEach(([e,t])=>{const n=e.x-t.x,o=e.y-t.y,s=Math.abs(n)+Math.abs(o)+g,r=x/s,i=n*r,l=o*r;e.dx-=i,t.dx+=i,e.dy-=l,t.dy+=l});const e=A(.5,.5,4,s);R(e),s.forEach(t=>B(t,e)),O()},F=()=>{0!==f.prevX&&(j+=f.y-f.prevY,$+=f.x-f.prevX,f.prevX=f.x,f.prevY=f.y),i.setTransform(Z,0,0,Z,$,j)},G=e=>i.fillRect(e.x-.5*e.textWidth-M,e.y-.008*e.mass-W,e.textWidth+2*M,.015*e.mass+2*W),J=e=>{i.font=`bold ${.015*e.mass}px Verdana`,i.fillText(e.title,e.x-.5*e.textWidth,e.y+.006*e.mass*.5)},N=()=>{i.save(),i.translate(-5e3,-5e3),i.clearRect(0,0,1e4,1e4),i.restore()},z=()=>{N(),i.strokeStyle="#a7a7a7",i.lineWidth=.002,r.forEach(([e,t])=>{i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(t.x,t.y),i.stroke()});const e=Math.floor(s.length/T);for(let t=0;t<e;t++){i.fillStyle="#eeeeee";for(let e=t*T;e<(t+1)*T;e++)G(s[e]);i.fillStyle="#000000";for(let e=t*T;e<(t+1)*T;e++)J(s[e])}i.fillStyle="#eeeeee";for(let t=e*T;t<s.length;t++)G(s[t]);i.fillStyle="#000000";for(let t=e*T;t<s.length;t++)J(s[t]);null!==d&&(i.strokeStyle="#80d7ff",i.lineWidth=.003,a.forEach(e=>{i.beginPath(),i.moveTo(d.x,d.y),i.lineTo(e.x,e.y),i.stroke()}),a.forEach(e=>{i.fillStyle="#80d7ff",G(e),i.fillStyle="#000000",J(e)}),i.fillStyle="#28bbff",G(d),i.fillStyle="#000000",J(d))},D=()=>{if(h){c&&q();const e=performance.now();(c||m)&&(H.innerText=Math.round(1e3/(e-l)),F(),z()),l=e,m=!1,requestAnimationFrame(D)}else N(),e=null,i=null,H=null,s=null,r=null};i=e.getContext("2d"),e.width=window.innerWidth;const V=e.getBoundingClientRect().top+(window.pageYOffset||document.documentElement.scrollTop);e.height=window.innerHeight-V;let Z=e.height,$=e.height/2,j=e.width/2,H=document.getElementById("fps");F(),e.addEventListener("mousemove",e=>{f.x=e.offsetX,f.y=e.offsetY,f.prevX&&(m=!0)});const K=(e,t)=>[(e-$)/Z,(t-j)/Z],Q=e=>{const[t,n]=K(e.offsetX,e.offsetY);for(let e=s.length-1;e>=0;e--){const o=s[e];if(t>=o.x-.5*o.textWidth-M&&n>=o.y-.008*o.mass-W&&t<=o.x+.5*o.textWidth+M&&n<=o.y+.007*o.mass+W){d=o,a=[];for(let[e,t]of r)e===d&&a.push(t),t===d&&a.push(e);return void(m=!0)}}f.prevX=e.offsetX,f.prevY=e.offsetY,m=!0};e.addEventListener("mousedown",Q);const U=e=>{f.prevX=0,f.prevY=0,m=!0};if(e.addEventListener("mouseup",U),e.addEventListener("mouseleave",U),e.addEventListener("keypress",e=>{"Space"===e.code&&(c=!c,e.stopPropagation(),e.preventDefault(),m=!0)}),e.addEventListener("wheel",e=>{const t=.01*e.deltaY*k,n=Z*(1-t);Z=n,e.preventDefault(),m=!0}),void 0!==n)s=n.nodes,r=n.edges.map(([e,t])=>[s[e],s[t]]);else{if(void 0===t)throw new Error("graph.js needs either roamJSON or precomputedGraph");{const e={};t.forEach((t,n)=>e[t.title]=n),s=t.map(e=>L(e.title)),r=[],edgeIdxs=[];const n={},o=(t,i)=>{if(void 0!==i.string){const o=[/\#([a-zA-Z]+)/g,/\[\[([^\]]+)\]\]/g,/^([a-zA-Z ]+)::/g];o.forEach(o=>{const l=i.string.matchAll(o);for(let o of l){const i=e[o[1]];if(void 0!==i){const e=t+1e6*i;void 0===n[e]&&(n[e]=!0,s[t].numConnections+=1,s[i].numConnections+=1,s[t],r.push([s[t],s[i]]),edgeIdxs.push([t,i]))}}})}void 0!==i.children&&i.children.forEach(e=>o(t,e))};t.forEach(t=>{void 0!==t.children&&t.children.forEach(n=>o(e[t.title],n))});for(let e of s)e.mass=.5*Math.pow(e.numConnections,.25)+1,e.inverseMass=1/e.mass,i.font=`bold ${.015*e.mass}px Verdana`,e.textWidth=i.measureText(e.title).width,e.inverseTextWidth=.4}}s=s.sort((e,t)=>e.mass-t.mass);for(let e=0;e<S;e++)q();return x*=v,y*=v,u*=v*v,w*=v,requestAnimationFrame(D),document.getElementById("startupTime").innerText=.001*Math.round(performance.now()-o),document.getElementById("status").innerText="Running",setTimeout(()=>c=!1,5e3),()=>h=!1};